<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>frozen: backend.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">frozen&#160;<span id="projectnumber">1.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">backend.h File Reference</div>  </div>
</div>
<div class="contents">

<p><a href="backend_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbackend__t.html">backend_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Backend structure.  <a href="structbackend__t.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5711a40fc84f6c6cbc4790023ead3983"></a><!-- doxytag: member="backend.h::f_init" ref="a5711a40fc84f6c6cbc4790023ead3983" args=")(backend_t *)" -->
typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a5711a40fc84f6c6cbc4790023ead3983">f_init</a> )(<a class="el" href="structbackend__t.html">backend_t</a> *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Init function for backend. Allocate userdata and init default values here. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8f9b05ebb264e32707a1c78d378736d9"></a><!-- doxytag: member="backend.h::f_fork" ref="a8f9b05ebb264e32707a1c78d378736d9" args=")(backend_t *, backend_t *, hash_t *)" -->
typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a8f9b05ebb264e32707a1c78d378736d9">f_fork</a> )(<a class="el" href="structbackend__t.html">backend_t</a> *, <a class="el" href="structbackend__t.html">backend_t</a> *, <a class="el" href="structhash__t.html">hash_t</a> *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fork function for backend. Make fork of current backend here. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a636f350214b041bc1a7a4c30cef76355"></a><!-- doxytag: member="backend.h::f_configure" ref="a636f350214b041bc1a7a4c30cef76355" args=")(backend_t *, hash_t *)" -->
typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a636f350214b041bc1a7a4c30cef76355">f_configure</a> )(<a class="el" href="structbackend__t.html">backend_t</a> *, <a class="el" href="structhash__t.html">hash_t</a> *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure function for backend. Try to make it reentrant. Assign configuration values and validate it here. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2789ce85c146dee49c43c8605509a5eb"></a><!-- doxytag: member="backend.h::f_destroy" ref="a2789ce85c146dee49c43c8605509a5eb" args=")(backend_t *)" -->
typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a2789ce85c146dee49c43c8605509a5eb">f_destroy</a> )(<a class="el" href="structbackend__t.html">backend_t</a> *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy function for backend. Free all allocated resources here. <br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0934fb6d780fef71f492d1e7d37e53d3"></a><!-- doxytag: member="backend.h::class_register" ref="a0934fb6d780fef71f492d1e7d37e53d3" args="(backend_t *proto)" -->
API ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a0934fb6d780fef71f492d1e7d37e53d3">class_register</a> (<a class="el" href="structbackend__t.html">backend_t</a> *proto)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Register new dynamic class. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae77409724fca309e3d3342efd2033c40"></a><!-- doxytag: member="backend.h::class_unregister" ref="ae77409724fca309e3d3342efd2033c40" args="(backend_t *proto)" -->
API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#ae77409724fca309e3d3342efd2033c40">class_unregister</a> (<a class="el" href="structbackend__t.html">backend_t</a> *proto)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister dynamic class. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">API <a class="el" href="structbackend__t.html">backend_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#aa27659bc6fafedca7f7473f5795fc63d">backend_new</a> (<a class="el" href="structhash__t.html">hash_t</a> *config)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create new backend.  <a href="#aa27659bc6fafedca7f7473f5795fc63d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1f968dfa0370b316549a74ae247e8efc"></a><!-- doxytag: member="backend.h::backend_acquire" ref="a1f968dfa0370b316549a74ae247e8efc" args="(char *name)" -->
API <a class="el" href="structbackend__t.html">backend_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a1f968dfa0370b316549a74ae247e8efc">backend_acquire</a> (char *name)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Find backend by name and increment ref counter. Use backend_destroy to free. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8aa4c5fcbd548e6b64c5d1cbcfda5588"></a><!-- doxytag: member="backend.h::backend_find" ref="a8aa4c5fcbd548e6b64c5d1cbcfda5588" args="(char *name)" -->
API <a class="el" href="structbackend__t.html">backend_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a8aa4c5fcbd548e6b64c5d1cbcfda5588">backend_find</a> (char *name)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Find backend by name. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a04e60ba9f1b6fc35c25979c6de3ac33d"></a><!-- doxytag: member="backend.h::backend_destroy" ref="a04e60ba9f1b6fc35c25979c6de3ac33d" args="(backend_t *backend)" -->
API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a04e60ba9f1b6fc35c25979c6de3ac33d">backend_destroy</a> (<a class="el" href="structbackend__t.html">backend_t</a> *backend)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy backend. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">API <a class="el" href="structbackend__t.html">backend_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a43f7db570466127a99a883fe6026ff4f">backend_clone</a> (<a class="el" href="structbackend__t.html">backend_t</a> *backend)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone backend.  <a href="#a43f7db570466127a99a883fe6026ff4f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">API <a class="el" href="structbackend__t.html">backend_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a74c876edbea39e28180bd62b764d8018">backend_fork</a> (<a class="el" href="structbackend__t.html">backend_t</a> *backend, <a class="el" href="structhash__t.html">request_t</a> *request)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fork whole chain of backends.  <a href="#a74c876edbea39e28180bd62b764d8018"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4b7dd22e58bef33869ae220bd996bf06"></a><!-- doxytag: member="backend.h::backend_query" ref="a4b7dd22e58bef33869ae220bd996bf06" args="(backend_t *backend, request_t *request)" -->
API ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a4b7dd22e58bef33869ae220bd996bf06">backend_query</a> (<a class="el" href="structbackend__t.html">backend_t</a> *backend, <a class="el" href="structhash__t.html">request_t</a> *request)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Query backend with hash request. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aed49e67546b5e9074103e9036690ddc1"></a><!-- doxytag: member="backend.h::backend_fast_query" ref="aed49e67546b5e9074103e9036690ddc1" args="(backend_t *backend, void *args)" -->
API ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#aed49e67546b5e9074103e9036690ddc1">backend_fast_query</a> (<a class="el" href="structbackend__t.html">backend_t</a> *backend, void *args)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Query backend with fast request. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">API ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a88147c9954fca2933ef532cb2d82b5eb">backend_pass</a> (<a class="el" href="structbackend__t.html">backend_t</a> *backend, <a class="el" href="structhash__t.html">request_t</a> *request)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Pass hash request to next backends in chain.  <a href="#a88147c9954fca2933ef532cb2d82b5eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">API ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a8b188614d3301519193630795c9e0824">backend_fast_pass</a> (<a class="el" href="structbackend__t.html">backend_t</a> *backend, void *args)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Pass fast request to next backends in chain.  <a href="#a8b188614d3301519193630795c9e0824"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4ed7505d7cbbcec60e6c8a67584f6739"></a><!-- doxytag: member="backend.h::backend_connect" ref="a4ed7505d7cbbcec60e6c8a67584f6739" args="(backend_t *parent, backend_t *child)" -->
API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a4ed7505d7cbbcec60e6c8a67584f6739">backend_connect</a> (<a class="el" href="structbackend__t.html">backend_t</a> *parent, <a class="el" href="structbackend__t.html">backend_t</a> *child)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create link between parent and child. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adfc71642dbbdc4145941a7d0bcebd3e0"></a><!-- doxytag: member="backend.h::backend_disconnect" ref="adfc71642dbbdc4145941a7d0bcebd3e0" args="(backend_t *parent, backend_t *child)" -->
API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#adfc71642dbbdc4145941a7d0bcebd3e0">backend_disconnect</a> (<a class="el" href="structbackend__t.html">backend_t</a> *parent, <a class="el" href="structbackend__t.html">backend_t</a> *child)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove link between parent and child. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8ae5ad4793bf4616c279baedab753e69"></a><!-- doxytag: member="backend.h::backend_insert" ref="a8ae5ad4793bf4616c279baedab753e69" args="(backend_t *parent, backend_t *new_child)" -->
API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a8ae5ad4793bf4616c279baedab753e69">backend_insert</a> (<a class="el" href="structbackend__t.html">backend_t</a> *parent, <a class="el" href="structbackend__t.html">backend_t</a> *new_child)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert new_child in between of backend and it's childs. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a687183f83f050b5b65a0ff77a171eb72"></a><!-- doxytag: member="backend.h::backend_add_terminators" ref="a687183f83f050b5b65a0ff77a171eb72" args="(backend_t *backend, list *terminators)" -->
API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend_8h.html#a687183f83f050b5b65a0ff77a171eb72">backend_add_terminators</a> (<a class="el" href="structbackend__t.html">backend_t</a> *backend, <a class="el" href="structlist.html">list</a> *terminators)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrap backend with terminators. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a36d767b30b24a429163f6726667b2a41"></a><!-- doxytag: member="backend.h::backend_destroy_all" ref="a36d767b30b24a429163f6726667b2a41" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>backend_destroy_all</b> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a12c3b51d2d7804902f1783c3889121cb"></a><!-- doxytag: member="backend.h::request_str_to_action" ref="a12c3b51d2d7804902f1783c3889121cb" args="(char *string)" -->
data_functions&#160;</td><td class="memItemRight" valign="bottom"><b>request_str_to_action</b> (char *string)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"></div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a43f7db570466127a99a883fe6026ff4f"></a><!-- doxytag: member="backend.h::backend_clone" ref="a43f7db570466127a99a883fe6026ff4f" args="(backend_t *backend)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">API <a class="el" href="structbackend__t.html">backend_t</a>* backend_clone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbackend__t.html">backend_t</a> *&#160;</td>
          <td class="paramname"><em>backend</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clone backend. </p>
<p>This function will create clone of supplied backend. Clone will not have links with any of backends. But it will have same pointer to userdata. No func_* functions will be called for it.</p>
<ul>
<li>Can be useful to make dummy backends, without full implementation with registration and classes. </li>
</ul>

</div>
</div>
<a class="anchor" id="a8b188614d3301519193630795c9e0824"></a><!-- doxytag: member="backend.h::backend_fast_pass" ref="a8b188614d3301519193630795c9e0824" args="(backend_t *backend, void *args)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">API ssize_t backend_fast_pass </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbackend__t.html">backend_t</a> *&#160;</td>
          <td class="paramname"><em>backend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pass fast request to next backends in chain. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">backend</td><td>Current backend </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a74c876edbea39e28180bd62b764d8018"></a><!-- doxytag: member="backend.h::backend_fork" ref="a74c876edbea39e28180bd62b764d8018" args="(backend_t *backend, request_t *request)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">API <a class="el" href="structbackend__t.html">backend_t</a>* backend_fork </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbackend__t.html">backend_t</a> *&#160;</td>
          <td class="paramname"><em>backend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhash__t.html">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fork whole chain of backends. </p>
<p>This function forks backends starting from suppliend backend. For each forked backend special function func_fork called, if supplied, or used ordinary configure.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">backend</td><td>Backend to fork </td></tr>
    <tr><td class="paramname">request</td><td>Fork request. Useful for passing some real-time configurations, like part of filename to open </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Fork failed </td></tr>
    <tr><td class="paramname">non-NULL</td><td>Fork successfull </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa27659bc6fafedca7f7473f5795fc63d"></a><!-- doxytag: member="backend.h::backend_new" ref="aa27659bc6fafedca7f7473f5795fc63d" args="(hash_t *config)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">API <a class="el" href="structbackend__t.html">backend_t</a>* backend_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhash__t.html">hash_t</a> *&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create new backend. </p>
<p>Configuration is hash with items in reverse order. For example: </p>
<div class="fragment"><pre class="fragment">       <a class="code" href="structhash__t.html" title="Hash item.">hash_t</a> example_cfg[] = {
             { 0, DATA_HASHT(
                   { HK(<span class="keyword">class</span>), DATA_STRING(<span class="stringliteral">&quot;storage/file&quot;</span>) },
                   hash_end
             )},
             { 0, DATA_HASHT(
                   { HK(<span class="keyword">class</span>), DATA_STRING(<span class="stringliteral">&quot;request/debug&quot;</span>) },
                   hash_end
             )},
             hash_end
       };
</pre></div><p> This config produce two backends: debug and file. Debug will have one child - file and will pass all requests to it. backend_new will return pointer to last created backend. In this case - this is debug.</p>
<ul>
<li>Use hash_null to avoid linkage between backend. <dl><dt><b>Return values:</b></dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Creation failed </td></tr>
    <tr><td class="paramname">non-NULL</td><td>Creation success </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

</div>
</div>
<a class="anchor" id="a88147c9954fca2933ef532cb2d82b5eb"></a><!-- doxytag: member="backend.h::backend_pass" ref="a88147c9954fca2933ef532cb2d82b5eb" args="(backend_t *backend, request_t *request)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">API ssize_t backend_pass </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structbackend__t.html">backend_t</a> *&#160;</td>
          <td class="paramname"><em>backend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhash__t.html">request_t</a> *&#160;</td>
          <td class="paramname"><em>request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pass hash request to next backends in chain. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">backend</td><td>Current backend </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Dec 21 2011 15:18:56 for frozen by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
